{% extends "base.html" %}
{% block content %}
<div class="row justify-content-center">
    <div class="col-md-6">
        <div class="card-custom">
            <h1 class="h3">無駄遣い記録</h1>
            <form action="{{ url_for('insert') }}" method="POST">
                
                <div class="mb-3">
                    <label class="form-label fw-bold small">日付</label>
                    <input type="date" name="date" id="date-input" class="form-control" required>
                </div>

                <div class="mb-3">
                    <label class="form-label fw-bold small">時間帯</label>
                    <div class="selectable-group" id="time-group">
                        <button type="button" class="selectable-btn" data-value="朝">朝</button>
                        <button type="button" class="selectable-btn" data-value="昼">昼</button>
                        <button type="button" class="selectable-btn" data-value="晩">晩</button>
                    </div>
                    <input type="hidden" name="time_period" id="hidden-time" required>
                </div>

                <div class="mb-3">
                    <label class="form-label fw-bold small">カテゴリー</label>
                    <div class="selectable-group" id="category-group">
                        <button type="button" class="selectable-btn" data-value="ドリンク">ドリンク</button>
                        <button type="button" class="selectable-btn" data-value="スナック">スナック</button>
                        <button type="button" class="selectable-btn" data-value="フード">フード</button>
                        <button type="button" class="selectable-btn" data-value="その他">その他</button>
                    </div>
                    <input type="hidden" name="category" id="hidden-category" required>
                </div>

                <div class="mb-4">
                    <label class="form-label fw-bold small">金額（円）</label>
                    <input type="number" name="amount" class="form-control form-control-lg" placeholder="150" required>
                </div>

                <button type="submit" class="submit-btn mb-3">登録する</button>
                
                <div class="text-center">
                    <a href="{{ url_for('index') }}" class="btn btn-link text-decoration-none fw-bold small" style="color: var(--text-color);">
                        &laquo; ホームに戻る
                    </a>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const dateInput = document.getElementById('date-input');
        dateInput.value = new Date().toISOString().split('T')[0];

        function setupSelect(groupId, hiddenId) {
            const group = document.getElementById(groupId);
            const hidden = document.getElementById(hiddenId);
            const buttons = group.querySelectorAll('.selectable-btn');

            buttons.forEach(btn => {
                btn.addEventListener('click', () => {
                    buttons.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    hidden.value = btn.getAttribute('data-value');
                });
            });
        }
        setupSelect('time-group', 'hidden-time');
        setupSelect('category-group', 'hidden-category');
    });
</script>
{% endblock %}